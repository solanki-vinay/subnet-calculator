<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Subnet Tools</title>

<style>
:root {
  --bg: #f5f6fa;
  --card: #ffffff;
  --muted: #64748b;
  --accent: #06b6d4;
  --accent2: #7c3aed;
  --gold: #FFD700;
  --text: #1e293b;
}
html, body { margin:0; font-family:Inter, ui-sans-serif; background:var(--bg); color:var(--text); }
.page { display:none; }

/* Home */
.home-wrapper { padding:50px 20px; min-height:100vh; }
.home-title { text-align:center; font-size:28px; font-weight:700; margin-bottom:28px; }
.tool-grid { display:flex; gap:24px; justify-content:center; flex-wrap:wrap; }
.tool-card { width:280px; background:var(--card); border-radius:14px; padding:24px;
  box-shadow:0 6px 16px rgba(0,0,0,0.08); cursor:pointer; transition:0.25s; }
.tool-card:hover { transform:translateY(-6px); box-shadow:0 10px 20px rgba(0,0,0,0.12); }
.tool-icon { font-size:32px; margin-bottom:8px; }
.tool-title { font-size:18px; font-weight:600; margin-bottom:6px; }
.tool-desc { font-size:14px; color:var(--muted); }

.back-btn { margin:20px; font-size:16px; color:var(--accent2); cursor:pointer; }

.app { max-width:960px; margin:20px auto; padding:24px; border-radius:12px; background:var(--card);
  box-shadow:0 8px 24px rgba(0,0,0,0.08); }
.controls { display:grid; grid-template-columns:1fr 160px 120px; gap:12px; margin-top:18px; }
.input, .btn { background:#f9fafb; padding:10px; border-radius:8px; border:1px solid rgba(0,0,0,0.08); }
.input label { font-size:13px; color:var(--muted); margin-bottom:6px; display:block; }
.input input { width:100%; background:transparent; border:0; outline:none; font-size:16px; }
.btn { display:flex; justify-content:center; align-items:center; cursor:pointer; user-select:none; }
.btn.primary { background:linear-gradient(90deg,var(--accent),var(--accent2)); color:#fff; font-weight:600; }

#message, #message6 { margin-top:10px; min-height:20px; }
.message-ok { color:#16a34a; } .message-err { color:#dc2626; }

.results { margin-top:20px; display:none; grid-template-columns:1fr 1fr; gap:18px; }
.cardbox { padding:16px; border-radius:10px; background:var(--card); box-shadow:0 4px 12px rgba(0,0,0,0.05); }
.cardbox h3 { margin:0 0 10px; }
table { width:100%; border-collapse:collapse; }
td, th { padding:6px; border-bottom:1px dashed rgba(0,0,0,0.1); text-align:left; }
.mono { font-family:monospace; }
.binary { font-family:monospace; background:#f1f5f9; padding:4px; border-radius:4px; display:inline-block; }
button.copy { background:var(--gold); color:#000; padding:6px 12px; border-radius:6px; border:1px solid #DAA520; cursor:pointer; margin-top:8px; }
</style>
</head>

<body>

<!-- HOME -->
<div id="page-home" class="page" style="display:block;">
  <div class="home-wrapper">
    <div class="home-title">Every tool you need to work with IPs in one place</div>
    <div class="tool-grid">
      <div class="tool-card" onclick="openPage('ipv4')">
        <div class="tool-icon">üåê</div>
        <div class="tool-title">IPv4 Calculator</div>
        <div class="tool-desc">CIDR, Netmask, Broadcast & Hosts.</div>
      </div>
      <div class="tool-card" onclick="openPage('ipv6')">
        <div class="tool-icon">üß©</div>
        <div class="tool-title">IPv6 Calculator</div>
        <div class="tool-desc">Prefixes, Compression & Network ranges.</div>
      </div>
    </div>
  </div>
</div>

<!-- IPv4 -->
<div id="page-ipv4" class="page">
  <div class="back-btn" onclick="openPage('home')">‚Üê Back</div>
  <div class="app">
    <h1>IPv4 Subnet Calculator</h1>
    <div class="controls">
      <div class="input"><label>IPv4 address & mask</label><input id="addrInput" placeholder="192.168.1.10/24 or 10.0.0.5 255.255.255.0"></div>
      <div class="input"><label>Optional prefix</label><input id="prefixInput" placeholder="24"></div>
      <div style="display:flex;flex-direction:column;gap:8px;">
        <div class="btn primary" id="calcBtn">Calculate</div>
        <div class="btn" id="resetBtn">Reset</div>
      </div>
    </div>
    <div id="message"></div>
    <div class="results" id="results">
      <div class="cardbox"><h3>Summary</h3><table>
        <tr><th>Address</th><td id="r_address"></td></tr>
        <tr><th>Netmask</th><td id="r_netmask"></td></tr>
        <tr><th>Wildcard</th><td id="r_wildcard"></td></tr>
        <tr><th>Network</th><td id="r_network"></td></tr>
        <tr><th>Broadcast</th><td id="r_broadcast"></td></tr>
        <tr><th>Host min</th><td id="r_hostmin"></td></tr>
        <tr><th>Host max</th><td id="r_hostmax"></td></tr>
        <tr><th>Hosts</th><td id="r_hostsnet"></td></tr>
        <tr><th>Class</th><td id="r_class"></td></tr>
        <tr><th>Scope</th><td id="r_scope"></td></tr>
      </table></div>
      <div class="cardbox"><h3>Binary</h3><table>
        <tr><td>Address</td><td id="b_address"></td><td id="b_address_bin"></td></tr>
        <tr><td>Netmask</td><td id="b_netmask"></td><td id="b_netmask_bin"></td></tr>
        <tr><td>Wildcard</td><td id="b_wildcard"></td><td id="b_wildcard_bin"></td></tr>
        <tr><td>Network</td><td id="b_network"></td><td id="b_network_bin"></td></tr>
        <tr><td>Broadcast</td><td id="b_broadcast"></td><td id="b_broadcast_bin"></td></tr>
        <tr><td>HostMin</td><td id="b_hostmin"></td><td id="b_hostmin_bin"></td></tr>
        <tr><td>HostMax</td><td id="b_hostmax"></td><td id="b_hostmax_bin"></td></tr>
      </table>
      <button class="copy" id="copyAll">Copy</button>
      <button class="copy" id="downloadCSV">CSV</button></div>
    </div>
  </div>
</div>

<!-- IPv6 -->
<div id="page-ipv6" class="page">
  <div class="back-btn" onclick="openPage('home')">‚Üê Back</div>
  <div class="app">
    <h1>IPv6 Subnet Calculator</h1>
    <div class="controls">
      <div class="input"><label>IPv6 address & prefix</label><input id="ipv6Input" placeholder="2001:db8::1/64"></div>
      <div style="display:flex;flex-direction:column;gap:8px;">
        <div class="btn primary" id="calcBtn6">Calculate</div>
        <div class="btn" id="resetBtn6">Reset</div>
      </div>
    </div>
    <div id="message6"></div>
    <div class="results" id="results6">
      <div class="cardbox"><h3>Summary</h3><table>
        <tr><th>Address</th><td id="r6_address"></td></tr>
        <tr><th>Prefix</th><td id="r6_prefix"></td></tr>
        <tr><th>Network</th><td id="r6_network"></td></tr>
        <tr><th>First address</th><td id="r6_first"></td></tr>
        <tr><th>Last address</th><td id="r6_last"></td></tr>
        <tr><th>Total addresses</th><td id="r6_range"></td></tr>
      </table></div>
      <div class="cardbox"><h3>Expanded & compressed</h3><table>
        <tr><td>Expanded</td><td id="r6_expanded"></td></tr>
        <tr><td>Compressed</td><td id="r6_compressed"></td></tr>
      </table></div>
    </div>
  </div>
</div>

<script>
// Page switcher
function openPage(page){
  document.querySelectorAll('.page').forEach(p=>p.style.display='none');
  document.getElementById('page-'+page).style.display='block';
}

/* ================= IPv4 ================= */
function ipToInt(ip){
  const parts = ip.trim().split('.').map(x=>parseInt(x,10));
  if(parts.length!==4 || parts.some(p=>isNaN(p)||p<0||p>255)) return null;
  return ((parts[0]<<24)>>>0) + ((parts[1]<<16)>>>0) + ((parts[2]<<8)>>>0) + (parts[3]>>>0);
}
function intToIp(int){
  return [(int>>>24)&255,(int>>>16)&255,(int>>>8)&255,int&255].join('.');
}
function intToBinaryOctets(int){
  return [(int>>>24)&255,(int>>>16)&255,(int>>>8)&255,int&255]
    .map(n=>n.toString(2).padStart(8,'0')).join(' ');
}
function prefixToMask(prefix){
  if(prefix<0||prefix>32) return null;
  return prefix===0?0:(~((1<<(32-prefix))-1))>>>0;
}
function maskToPrefix(maskInt){
  let c=0;
  for(let i=31;i>=0;i--){
    if(maskInt&(1<<i)) c++; else break;
  }
  if(((maskInt<<c)>>>0)!==0) return null;
  return c;
}
function wildcardFromMask(maskInt){ return (~maskInt)>>>0; }
function isPrivate(ipInt){
  if((ipInt>>>24)===10) return true;
  if(ipInt>=ipToInt('172.16.0.0') && ipInt<=ipToInt('172.31.255.255')) return true;
  if(ipInt>=ipToInt('192.168.0.0') && ipInt<=ipToInt('192.168.255.255')) return true;
  return false;
}
function classOf(ipInt){
  const first=(ipInt>>>24)&255;
  if(first<=127) return 'A';
  if(first<=191) return 'B';
  if(first<=223) return 'C';
  if(first<=239) return 'D (Multicast)';
  return 'E (Reserved)';
}
function parseInput(raw,px){
  raw=raw.trim();
  if(!raw) return null;
  let ipStr=raw, prefix=null, maskStr=null;
  if(raw.includes('/')){
    const[a,p]=raw.split('/');
    ipStr=a.trim(); prefix=parseInt(p.trim());
  }else if(raw.split(' ').length===2){
    const[a,b]=raw.split(' ');
    ipStr=a.trim(); maskStr=b.trim();
    if(maskStr.includes('.')){
      const mInt=ipToInt(maskStr); if(mInt===null) return null;
      prefix=maskToPrefix(mInt);
    }else prefix=parseInt(maskStr);
  }
  if(px){ let p=parseInt(px); if(!isNaN(p)) prefix=p; }
  const ipInt=ipToInt(ipStr);
  if(ipInt===null) return null;
  if(prefix===null||isNaN(prefix)) return {ipInt,prefix:null};
  if(prefix<0||prefix>32) return null;
  return {ipInt,prefix};
}
function calculate(ipInt,prefix){
  const maskInt=prefixToMask(prefix);
  const wild=wildcardFromMask(maskInt);
  const network=(ipInt&maskInt)>>>0;
  const broadcast=(network|wild)>>>0;
  let hostMin=null,hostMax=null,hostsPer=0;
  if(prefix<=30){
    hostsPer=(1<<(32-prefix))-2;
    hostMin=(network+1)>>>0;
    hostMax=(broadcast-1)>>>0;
  } else if(prefix===31){
    hostsPer=0; hostMin=network; hostMax=broadcast;
  } else {
    hostsPer=1; hostMin=network; hostMax=network;
  }
  return{maskInt,wild,network,broadcast,hostMin,hostMax,hostsPer};
}
function renderIPv4(parsed){
  const{ipInt,prefix}=parsed;
  if(prefix===null){ showMessage("Prefix missing",true); return; }
  const data=calculate(ipInt,prefix);
  document.getElementById('r_address').innerHTML = `<span class="mono">${intToIp(ipInt)}/${prefix}</span>`;
  document.getElementById('r_netmask').textContent=intToIp(data.maskInt);
  document.getElementById('r_wildcard').textContent=intToIp(data.wild);
  document.getElementById('r_network').textContent=intToIp(data.network);
  document.getElementById('r_broadcast').textContent=intToIp(data.broadcast);
  document.getElementById('r_hostmin').textContent = data.hostMin?intToIp(data.hostMin):"-";
  document.getElementById('r_hostmax').textContent = data.hostMax?intToIp(data.hostMax):"-";
  document.getElementById('r_hostsnet').textContent=data.hostsPer;
  document.getElementById('r_class').textContent=classOf(ipInt);
  document.getElementById('r_scope').textContent=isPrivate(ipInt)?"Private":"Public";
  // Binary
  document.getElementById('b_address').textContent=intToIp(ipInt);
  document.getElementById('b_address_bin').innerHTML=`<span class="binary">${intToBinaryOctets(ipInt)}</span>`;
  document.getElementById('b_netmask').textContent=intToIp(data.maskInt);
  document.getElementById('b_netmask_bin').innerHTML=`<span class="binary">${intToBinaryOctets(data.maskInt)}</span>`;
  document.getElementById('b_wildcard').textContent=intToIp(data.wild);
  document.getElementById('b_wildcard_bin').innerHTML=`<span class="binary">${intToBinaryOctets(data.wild)}</span>`;
  document.getElementById('b_network').textContent=intToIp(data.network);
  document.getElementById('b_network_bin').innerHTML=`<span class="binary">${intToBinaryOctets(data.network)}</span>`;
  document.getElementById('b_broadcast').textContent=intToIp(data.broadcast);
  document.getElementById('b_broadcast_bin').innerHTML=`<span class="binary">${intToBinaryOctets(data.broadcast)}</span>`;
  document.getElementById('b_hostmin').textContent=data.hostMin?intToIp(data.hostMin):"-";
  document.getElementById('b_hostmin_bin').innerHTML=data.hostMin?`<span class="binary">${intToBinaryOctets(data.hostMin)}</span>`:"-";
  document.getElementById('b_hostmax').textContent=data.hostMax?intToIp(data.hostMax):"-";
  document.getElementById('b_hostmax_bin').innerHTML=data.hostMax?`<span class="binary">${intToBinaryOctets(data.hostMax)}</span>`:"-";
  document.getElementById('results').style.display="grid";
  showMessage("Calculated ‚úì",false);
}
const addrInput=document.getElementById('addrInput');
const prefixInput=document.getElementById('prefixInput');
const calcBtn=document.getElementById('calcBtn');
const resetBtn=document.getElementById('resetBtn');
const msg=document.getElementById('message');
function showMessage(s,err=false){ msg.className = err ? 'message-err' : 'message-ok'; msg.textContent=s; }
calcBtn.onclick=()=>{
  showMessage("");
  const parsed=parseInput(addrInput.value,prefixInput.value);
  if(!parsed){ showMessage("Invalid IPv4 input",true); document.getElementById('results').style.display="none"; return; }
  if(parsed.prefix===null){ showMessage("Prefix not found",true); return; }
  renderIPv4(parsed);
};
resetBtn.onclick=()=>{
  addrInput.value=""; prefixInput.value=""; msg.textContent=""; msg.className="";
  document.getElementById('results').style.display="none";
};
document.getElementById('copyAll').onclick=()=>{
  const rows=document.querySelectorAll('#results .cardbox table tr');
  let out=""; rows.forEach(r=>{ if(r.children.length>=2) out+=r.children[0].innerText+": "+r.children[1].innerText+"\n"; });
  navigator.clipboard.writeText(out); showMessage("Copied ‚úì",false);
};
document.getElementById('downloadCSV').onclick=()=>{
  const rows=[
    ["Field","Value","Binary"],
    ["Address",b_address.textContent,b_address_bin.innerText],
    ["Netmask",b_netmask.textContent,b_netmask_bin.innerText],
    ["Wildcard",b_wildcard.textContent,b_wildcard_bin.innerText],
    ["Network",b_network.textContent,b_network_bin.innerText],
    ["Broadcast",b_broadcast.textContent,b_broadcast_bin.innerText],
    ["HostMin",b_hostmin.textContent,b_hostmin_bin.innerText],
    ["HostMax",b_hostmax.textContent,b_hostmax_bin.innerText],
  ];
  const csv=rows.map(r=>r.join(",")).join("\n");
  const blob=new Blob([csv],{type:'text/csv'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download="ipv4.csv"; a.click();
  URL.revokeObjectURL(url);
};

/* ================= IPv6 ================= */
/* Expand/compress helpers */
function expandIPv6(addr){
  // Separate IPv4 tail if present (IPv4-mapped or embedded)
  let ipv4Tail = null;
  if(addr.includes('.')){
    const lastColon = addr.lastIndexOf(':');
    ipv4Tail = addr.slice(lastColon+1);
    addr = addr.slice(0,lastColon);
    const ipv4Parts = ipv4Tail.split('.').map(x=>parseInt(x,10));
    if(ipv4Parts.length!==4 || ipv4Parts.some(p=>isNaN(p)||p<0||p>255)) return null;
    // Convert IPv4 to two hextets
    const h6 = ((ipv4Parts[0]<<8)|ipv4Parts[1]).toString(16);
    const h7 = ((ipv4Parts[2]<<8)|ipv4Parts[3]).toString(16);
    ipv4Tail = [h6, h7];
  }
  const parts = addr.split('::');
  let left = parts[0] ? parts[0].split(':').filter(Boolean) : [];
  let right = parts[1] ? parts[1].split(':').filter(Boolean) : [];
  if(parts.length===1){
    // No ::
    while(left.length<8) left.push('0');
  } else {
    const missing = 8 - (left.length + right.length + (ipv4Tail?2:0));
    const zeros = Array(missing).fill('0');
    left = [...left, ...zeros, ...right];
  }
  if(ipv4Tail){ left = [...left.slice(0,6), ...ipv4Tail]; }
  if(left.length!==8) return null;
  return left.map(x=>x.padStart(4,'0').toLowerCase()).join(':');
}
function compressIPv6(expanded){
  const parts = expanded.split(':').map(h=>h.replace(/^0+/, '') || '0');
  // Find longest zero run
  let bestStart=-1, bestLen=0, curStart=-1, curLen=0;
  for(let i=0;i<parts.length;i++){
    if(parts[i]==='0'){
      if(curStart===-1) curStart=i;
      curLen++;
      if(curLen>bestLen){ bestLen=curLen; bestStart=curStart; }
    } else { curStart=-1; curLen=0; }
  }
  let out = parts.slice();
  if(bestLen>1){
    out.splice(bestStart, bestLen, '');
    // Remove adjacent empty markers
    out = out.filter((v,i)=> !(v==='' && i>0 && out[i-1]===''));
    // Add markers
    out = (bestStart===0 ? [''] : out.slice(0,bestStart))
          .concat([''])
          .concat(out.slice(bestStart));
  }
  let str = out.join(':').replace(/(^:)/,'').replace(/(:$)/,'');
  // Normalize single hextet zeros
  return str.replace(/:{3,}/,'::');
}
/* BigInt conversions */
function ipv6ToBigInt(expanded){
  const parts = expanded.split(':').map(h=>parseInt(h,16));
  let val = 0n;
  for(let i=0;i<8;i++){
    val = (val<<16n) + BigInt(parts[i]);
  }
  return val;
}
function bigIntToIPv6(big){
  const parts = [];
  for(let i=0;i<8;i++){
    const shift = BigInt(16*(7-i));
    const hextet = Number((big >> (shift)) & 0xffffn);
    parts.push(hextet.toString(16).padStart(4,'0'));
  }
  return parts.join(':');
}
function parseIPv6Input(raw){
  raw = raw.trim();
  if(!raw) return null;
  let addr = raw, prefix = null;
  if(raw.includes('/')){
    const [a,p] = raw.split('/');
    addr = a.trim(); prefix = parseInt(p.trim(),10);
  }
  if(prefix===null || isNaN(prefix) || prefix<0 || prefix>128) return null;
  const expanded = expandIPv6(addr);
  if(!expanded) return null;
  return { addr, prefix, expanded };
}
function calcIPv6Network(expanded, prefix){
  const val = ipv6ToBigInt(expanded);
  const hostBits = BigInt(128 - prefix);
  const mask = hostBits===128n ? 0n : (~((1n<<hostBits)-1n)) & ((1n<<128n)-1n);
  const network = val & mask;
  const first = network; // IPv6 has no broadcast; first address is network itself
  const last = network + ((1n<<hostBits) - 1n);
  const total = (1n<<hostBits);
  return { network, first, last, total };
}
function showMessage6(s,err=false){ const m=document.getElementById('message6'); m.className=err?'message-err':'message-ok'; m.textContent=s; }
function renderIPv6(parsed){
  const { addr, prefix, expanded } = parsed;
  const data = calcIPv6Network(expanded, prefix);
  const networkStr = compressIPv6(bigIntToIPv6(data.network));
  const firstStr = compressIPv6(bigIntToIPv6(data.first));
  const lastStr = compressIPv6(bigIntToIPv6(data.last));
  const compressed = compressIPv6(expanded);

  document.getElementById('r6_address').textContent = `${addr}/${prefix}`;
  document.getElementById('r6_prefix').textContent = `${prefix}`;
  document.getElementById('r6_network').textContent = `${networkStr}/${prefix}`;
  document.getElementById('r6_first').textContent = firstStr;
  document.getElementById('r6_last').textContent = lastStr;
  document.getElementById('r6_range').textContent = data.total.toString() + " addresses";

  document.getElementById('r6_expanded').textContent = expanded;
  document.getElementById('r6_compressed').textContent = compressed;

  document.getElementById('results6').style.display = "grid";
  showMessage6("Calculated ‚úì", false);
}
const ipv6Input = document.getElementById('ipv6Input');
document.getElementById('calcBtn6').onclick = ()=>{
  showMessage6("");
  const parsed = parseIPv6Input(ipv6Input.value);
  if(!parsed){ showMessage6("Invalid IPv6 input", true); document.getElementById('results6').style.display="none"; return; }
  renderIPv6(parsed);
};
document.getElementById('resetBtn6').onclick = ()=>{
  ipv6Input.value=""; const m=document.getElementById('message6'); m.textContent=""; m.className="";
  document.getElementById('results6').style.display="none";
};
</script>

</body>
</html>
